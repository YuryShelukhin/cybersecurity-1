# Домашнее задание к занятию «Уязвимости и атаки на информационные системы». Шелухин Юрий


### Задание 1

1. Скачайте и установите виртуальную машину Metasploitable: https://sourceforge.net/projects/metasploitable/. Это типовая ОС для экспериментов в области информационной безопасности, с которой следует начать при анализе уязвимостей.  
2. Просканируйте эту виртуальную машину, используя **nmap**. Попробуйте найти уязвимости, которым подвержена эта виртуальная машина.  
Сами уязвимости можно поискать на сайте https://www.exploit-db.com/.  Для этого нужно в поиске ввести название сетевой службы, обнаруженной на атакуемой машине, и выбрать подходящие по версии уязвимости.  
3. Ответьте на следующие вопросы:  
- Какие сетевые службы в ней разрешены?  
- Какие уязвимости были вами обнаружены? (список со ссылками: достаточно трёх уязвимостей)  
*Приведите ответ в свободной форме.*    

**Решение**

1. Запустим виртуальную машину Metasploitable посредством VMware Workstation. Запустим и найдем её сетевой адрес.  

<img src = "img/1-1-1.jpeg" width = 60%>  

Проверим ping к Metasploitable.

<img src = "img/1-1-2.png" width = 60%>

**2-3.** Установим Nmap. Применим агрессивный режим сканирования хоста Metasploitable.  
`nmap -A 192.168.65.128`

Получим результат.

<img src = "img/1-2-1.png" width = 60%>  

Найдено несколько разрешенных сетевых служб.

-21/tcp - FTP (vsftpd 2.3.4);

<img src = "img/1-2-2.png" width = 60%>

-22/tcp - SSH (OpenSSH 4.7p1);

<img src = "img/1-2-3.png" width = 60%>

-23/tcp - Telnet;

<img src = "img/1-2-4.png" width = 60%>

-25/tcp - SMTP (Postfix);

<img src = "img/1-2-5.png" width = 60%>

-53/tcp - DNS (ISC BIND 9.4.2).

<img src = "img/1-2-6.png" width = 60%>

Проверим уязвимости с использованием сайта https://www.exploit-db.com/ и другой информации в сети.  

`FTP (vsftpd 2.3.4)` -  backdoor, разрешен доступ анонимному пользователю.

<img src = "img/1-2-7.png" width = 60%>

`OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)` - устаревшая на несколько поколений версия. Риск: Weak keys, brute force атаки.

<img src = "img/1-2-8.png" width = 60%>

`Telnet` - Незашифрованное соединение, возможен перехват учетных данных

<img src = "img/1-2-9.png" width = 60%>  


`SMTP (Postfix)` - SSLv2 поддержка (устаревшая и небезопасная) перебор пользователей, brute force.
 

<img src = "img/1-2-10.png" width = 60%> 


`DNS (ISC BIND 9.4.2)` - может раскрывать информацию о сети.


Самая большая уязdимость - `Bind Shell (port 1524)`. Выявлен открытый bindshell от root. Прямой root доступ без аутентификации.

<img src = "img/1-2-11.png" width = 60%> 

---


### Задание 2.

Проведите сканирование Metasploitable в режимах SYN, FIN, Xmas, UDP. Запишите сеансы сканирования в Wireshark.  
Ответьте на следующие вопросы:  
- Чем отличаются эти режимы сканирования с точки зрения сетевого трафика?  
- Как отвечает сервер?   
*Приведите ответ в свободной форме.*  

**Решение**

Установим wireshark. Проведем сканирование в режимах:  

-syn  

<img src = "img/2-1.png" width = 60%>     
<img src = "img/2-2.png" width = 60%>   

Этот метод дает картину реально доступных сетевых служб без установления полных соединений. Направляется SYN пакет. Ответы SYN указывают на то, что порт прослушивается (открыт), а RST (сброс) на то, что не прослушивается. Если после нескольких запросов не приходит никакого ответа, то порт помечается как фильтруемый. Также помечается как фильтруемый, когда в ответ приходит ICMP сообщение об ошибке.  

-FIN  

<img src = "img/2-3.png" width = 60%>   
<img src = "img/2-4.png" width = 60%>      

Этот метод НЕ определяет открытые/закрытые порты, а только Фильтруется ли порт firewall'ом и доступен ли порт для подключения. Для получения информации направляется SYN-ACK пакет. Ответ RST - порт доступен. Нет ответа или ошибка- порт фильтруется.  

-Xmas

<img src = "img/2-5.png" width = 60%>   
<img src = "img/2-6.png" width = 60%>      

Оправляемые флаги FIN + URG + PSH (все сразу).  Ответ RST/ACK - порт закрыт. Нет ответа - порт открыт ИЛИ фильтруется. ICMP ошибка - порт фильтруется. Xmas scan полезен для первоначальной разведки через строгие firewall'ы, тестирования IDS/IPS систем, скрытного сканирования UNIX-систем.  

-UDP   

<img src = "img/2-7.png" width = 60%>  
<img src = "img/2-8.png" width = 60%>  

Работает путем посылки пустого (без данных) UDP заголовка на каждый целевой порт. Обнаруживает UDP службы (невидимые для TCP сканирования), находит уязвимости в DNS, SNMP, TFTP. Определяет реально работающие UDP сервисы.  Если в ответ приходит ICMP ошибка о недостижимости порта (тип 3, код 3), значит порт закрыт.  Другие ICMP ошибки недостижимости (тип 3, коды 1, 2, 9, 10 или 13) указывают на то, что порт фильтруется. Иногда, служба будет отвечать UDP пакетом, указывая на то, что порт открыт. Если после нескольких попыток не было получено никакого ответа, то порт классифицируется как открыт|фильтруется. Это означает, что порт может быть открыт, или, возможно, пакетный фильтр блокирует его. Работает медленно - в моем случае больше 15 минут. 

--- 


